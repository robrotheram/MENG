<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for scripts/3DView/3DView.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../prettify.css">
    <link rel="stylesheet" href="../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header high">
    <h1>Code coverage report for <span class="entity">scripts/3DView/3DView.js</span></h1>
    <h2>
        Statements: <span class="metric">94.44% <small>(34 / 36)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">50% <small>(1 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">100% <small>(6 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">94.44% <small>(34 / 36)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">scripts/3DView/</a> &#187; 3DView.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">define(['jquery', 'three', '../3DView/3DCanvas', '../3DView/modelManager', 'three-controls', '../3DView/modelinfo'], function () {
&nbsp;
  /**
   * @class _3DView
   * @memberOf 3DView
   */
&nbsp;
  var texture = THREE.ImageUtils.loadTexture('images/steel.jpg');
  //texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
&nbsp;
  _3DView = {
    renderer: renderer,
    modelInfomation: modelinfo,
    /**
     * @name new
     * @function new
     * @memberOf 3DView._3DView
     * @description Reset the _3DView with defualt values. Call before setting up the canvas
     */
    new: function () {
      this.modelInfomation.reset();
      this.models.reset();
      this.animate = null;
      this.vector = new THREE.Vector3();
      this.testnumber = 100;
      this.raycaster = new THREE.Raycaster();
      this.outercontainer = null;
      this.speed = 0.005;
      this.play = false;
&nbsp;
    },
    /**
     * @name init
     * @function init
     * @memberOf 3DView._3DView
     * @description Sets up the canvas with the id of the div that the 3D view should be
     * @param {string} containerID div id of the container ID
     *
     */
    init: function (containerID) {
      this.outercontainer = $(containerID);
      this.renderer.init($(containerID));
      this.load();
      this.renderer.camera.position.x = 40;
      this.renderer.camera.position.y = 22;
      this.renderer.camera.position.z = 35;
      document.addEventListener('click', this.onSelectPart);
&nbsp;
    },
    animate: null,
    models: modelManager,
    vector: new THREE.Vector3(),
    testnumber: 100,
    raycaster: new THREE.Raycaster(),
    outercontainer: null,
    speed: 0.005,
    play: false,
&nbsp;
    /**
     * @name load
     * @function load
     * @memberOf 3DView._3DView
     * @description call the load function in model
     *
     */
    load: function () {
      this.models.load(this.renderer.scene);
    },
    /**
     * @name reset
     * @function reset
     * @memberOf 3DView._3DView
     * @description reset the camera to default positions
     *
     */
    reset: function () {
      this.play = false;
      this.renderer.camera.position.x = 150;
      this.renderer.camera.position.y = 40;
      this.renderer.camera.position.z = 150;
    },
    selectPart: null,
    /**
     * @name onSelectPart
     * @function onSelectPart
     * @memberOf 3DView._3DView
     * @description Called when there is a mouse click on the container. Calculates relative mosuse position in 3D space then uses THREE.RayCaster to get list of objects that the user could click on then sends the top most one the selectpart function
     * @param {Mouse}event Mouse Event
     */
    onSelectPart: function (event) {
      var mouse = {x: 0, y: 0};
      mouse.x = ((event.clientX - _3DView.outercontainer.offset().left) / _3DView.outercontainer.width() ) * 2 - 1;
      mouse.y = -(((event.pageY - _3DView.outercontainer.offset().top) / _3DView.outercontainer.outerHeight() ) * 2 - 1);
      _3DView.vector.set(mouse.x, mouse.y, 0.5);
      _3DView.vector.unproject(_3DView.renderer.camera);
      _3DView.raycaster.set(_3DView.renderer.camera.position,
        _3DView.vector.sub(_3DView.renderer.camera.position).normalize());
&nbsp;
      jetEngineArr = _3DView.models.convertToArray();
      intersects = _3DView.raycaster.intersectObjects(jetEngineArr);
      for (var modelID in _3DView.models.models) {
<span class="cstat-no" title="statement not covered" >        _3DView.models.models[modelID].material = _3DView.models.modelMaterialArray[modelID]; </span>// new THREE.MeshNormalMaterial();  // modelManager.materialarray[modelID];
      }
      <span class="missing-if-branch" title="if path not taken" >I</span>if (intersects.length &gt; 0) {
<span class="cstat-no" title="statement not covered" >        _3DView.selectPart(intersects[0].object);</span>
      }
    }
  }
});
&nbsp;</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Apr 28 2015 19:15:39 GMT+0100 (BST)</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
